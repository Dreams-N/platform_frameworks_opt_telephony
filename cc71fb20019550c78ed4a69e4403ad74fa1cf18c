Revision: cc71fb20019550c78ed4a69e4403ad74fa1cf18c
Patch-set: 4
File: src/java/com/android/internal/telephony/uicc/UiccController.java

0
Fri Apr 25 17:20:17 2014 +0000
Author: Abhishek Adappa <1023068@85c56323-6fa9-3386-8a01-6480fb634889>
UUID: a593eb68_45f28ec0
Bytes: 481
It is not clear to me what is the exact problem that we are trying to solve.

In AOSP, on radio available, we query sim status. This could be a redundant query in the case where rild crashes and there is no SIM. However, even in the case of a redundant query the modem would be expected to return the actual card state. I would expect the card state to be the same before and after the crash, resulting in no change on the frameworks, but I could be wrong.

Am I missing something?

0
Fri Apr 25 22:25:38 2014 +0000
Author: Abhishek Adappa <1023068@85c56323-6fa9-3386-8a01-6480fb634889>
Parent: a593eb68_45f28ec0
UUID: c5fb7fcc_a40d620a
Bytes: 783
I looked at the logs (bugreport-2014-04-17-20-45-11) associated with the bug and I see that the modem is frequently reporting the card state from absent to error to absent.

We should probably investigate the cause for why the modem is doing that. 

Even if the modem does that, I think we could fix the problem of the annoying prompts by fixing the condition in UiccCard.java.

Currently it checks for the following:
 if (oldState != CardState.CARDSTATE_ABSENT &&
          mCardState == CardState.CARDSTATE_ABSENT) {
    // prompt card removed
 
  } else if (oldState == CardState.CARDSTATE_ABSENT &&
          mCardState != CardState.CARDSTATE_ABSENT) {
     // prompt card inserted
  }


Instead we could use the transition from ABSENT to PRESENT to mean inserted and vice versa.

178:21-178:45
Fri Apr 25 15:54:10 2014 +0000
Author: Wink Saville <1001401@85c56323-6fa9-3386-8a01-6480fb634889>
UUID: 05767712_8633aa2f
Bytes: 69
Should we ignore this event if mFirstRadioAvailabeReceived == false ?

